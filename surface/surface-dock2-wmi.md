---
title: Управление Surface Dock 2 с помощью WMI
description: В этой статье объясняется, как использовать WMI для удаленного мониторинга и управления актуальными микропрограммами, состоянием политики и связанными данными на устройствах Surface Dock 2.
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 10/12/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
ms.openlocfilehash: 06933d49e99862fb19d0f6a09c9680a127b755cd
ms.sourcegitcommit: c1efb75e8524193bdc0a5f7496dc23a92ac665c8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/12/2020
ms.locfileid: "11114657"
---
# Управление Surface Dock 2 с помощью WMI

Поддержка инструментария управления Windows (WMI) предоставляет широкий набор диагностических данных, позволяющий администраторам удаленно отслеживать и управлять последними микропрограммами, состоянием политики и связанными данными на устройствах Surface Dock 2. Вы можете использовать WMI в Windows PowerShell, System Center Operations Manager и других средствах. Дополнительные сведения об инструментарии WMI: [в разделе Работа с WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true). 

Чтобы включить поддержку WMI, перейдите в раздел [драйверы и микропрограммы Surface Dock 2](https://www.microsoft.com/download/details.aspx?id=101317) и загрузите соответствующий пакет:

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;версии # C1_x64.msi:**<br>

- Surface Pro (5-й Gen и более поздние версии)
- Surface Book (вторая Gen и более поздние версии)
- Surface Go (все поколения)
- Surface ноутбук (все поколения)
- Ноутбук Surface Go

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;версии # C1_arm64.msi:** <br>

- Surface Pro X

##  <a name="using-wmi-with-surface-dock-2"></a>Использование WMI с Dock Surface 2

1. Чтобы перечислить все экземпляры компонента Dock, выполните указанные ниже действия.

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. Для доступа к описаниям свойств класса WMI откройте командную строке и введите команды WMI, где **свойство** является одним из свойств, перечисленных в таблице 1.

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **Пример:** Чтобы получить описание свойства CIM, **Version** введите следующую информацию:
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ###  <a name="surface-hub-2-fingerprint-reader-tech-specs"></a>Таблица1. Справочник по WMI для Surface Dock 2

| Свойство         | Тип   | Ожидаемые значения (-ов)                                                                                                                                                                                                            | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | Строка | Микроконтроллера <br>"USB-концентратор 1" <br>"USB-концентратор 2" <br>"Концентратор отображения порта" <br>"Контроллер доставки Power" <br>"Аудиокодек" <br>"Ethernet-контроллер"                                                                         | В следующем свойстве указывается конкретное имя компонента устройства, которому соответствуют данные класса CIM.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| DeviceName       | Строка | "Док Surface 1" <br>"Закрепляемая Surface 2"                                                                                                                                                                                        | В следующем свойстве содержится имя устройства Dock, которому принадлежит конкретный компонент устройства.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | Строка | 12-разрядный серийный номер, содержащий только числовые значения.                                                                                                                                                           | В следующем свойстве регистрируется серийный номер подключенного устройства Dock. Этот серийный номер является точным для всех компонентов, которые принадлежат одному и тому же устройству Dock. Для справки этот серийный номер можно найти физически с помощью части самой поверхности стыковочного узла.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Id               | UInt16 | 0, 1, 2,..., 65535                                                                                                                                                                                                          | Следующее свойство — уникальный идентификатор, который начинается с нуля (0) и подсчитывается вверх. Эта переменная используется для нумерации перечислимых экземпляров WMI.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | Строка | Ошибкой <br>"PendingDockReattach" <br>Ошибкой                                                                                                                                                                             | В приведенном ниже свойстве указаны сведения о последнем предпринятом обновлении встроенного по компонента (CFU) для рассматриваемого компонента устройства. Возможны следующие значения: **успешное** **пересоединение Dock, ожидание присоединения** и **сбой.**<br><br><br>- **Успех** указывает на то, что ранее примененное программное обеспечение успешно применено<br>- Повторное **Присоединение отложенных закрепления** указывает на то, что для компонента устройства ожидается новое обновление, и пользователь должен отсоединить и повторно прикрепить соединительную линию Dock, чтобы применить новое обновление.<br>- **Ошибка указывает на** то, что во время процесса CFU возникла допустимая ошибка, или периферийное устройство не загрузилось в ожидаемую версию. В случае **сбоя** это не означает, что устройство не работает, но при попытке обновить устройство возникло сообщение об ошибке. В этом случае предыдущее встроенное по будет продолжать работу.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| PolicyState      | Строка | Включаем <br>Отключает                                                                                                                                                                                                     | Следующее свойство указывает текущую политику корпоративного режима управления Surface (SEMM) для компонента устройства. Возможные значения: **включено** и **отключено.**<br><br><br>- **Enabled** указывает на то, что система SEMM позволяла ведущему устройству получить доступ к компоненту устройства и использовать его.<br>- **Disabled** указывает на то, что SEMM система не допускает доступ к компоненту устройства и, следовательно, препятствует компьютеру хоста.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProductId        | String [] | Список шестнадцатеричных строк, каждый из которых должен находиться в диапазоне от "0x0000" до "0xFFFF"                                                                                                                                                        | Следующее свойство классифицирует код продукта (PID) компонента устройства. Возможно, у вас есть более одного номера PID в списке. В случае USB-концентратора, например, устройства с высокой скоростью (SS) и высокоскоростной (HS) устройствами работают в единственном числе "Hub". Следовательно, два (2) PID будут перечислены в этом массиве.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProvisionedState         | логический | Истина или ложь                                                                                                                                                        | В следующем свойстве описывается состояние рабочего режима управления Surface (SEMM) для устройства Dock Surface. Состояние подготовки — это то же самое, что и каждый компонент, когда они принадлежат одному и тому же устройству Dock. Возможные значения: true или false. Значение true указывает на то, что устройство стыковочного устройства в настоящее время управляется и, следовательно, функция порта может быть ограничена. Для получения дополнительных сведений просмотрите поле свойства "PolicyState". Значение false указывает на то, что устройство Surface Dock в настоящее время не управляется и не имеет ограничений на функциональность.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Состояние           | Строка | ' <br>Изолирован <br>Ошибки <br>Указан <br>"DeviceHandleInUse" <br>Отключает <br>"NotSupportedByWmi"                                                                                                             | В следующем свойстве описывается состояние соединения Dock с хост-компьютером. Возможные значения: " **ОК", "** **отключено** **", "** **Ошибка",** " **DeviceHandleInUse**", "**отключено** " и " **NotSupportedByWmi".**   <br>- Это **означает,** что устройство успешно подключено к ведущему компьютеру и проблемы не существуют, что может препятствовать ее функционированию. <br>- " **Отключено** " означает, что соединитель Surface, который предоставляет подключение для всех компонентов устройства, в настоящее время не подключен к ведущему компьютеру. <br>- **Ошибка** указывает на возможную неполадку, связанную с экземпляром устройства, а интерфейс устройства в диспетчере устройств имеет больше, чем возможно, с желтым восклицательным знаком, проверьте свойство **StatusCode** для получения более подробной информации о типе возникшей ошибки. <br>- **Missing** указывает на то, что устройство должно быть перечислено на хостном компьютере, но по какой – либо причине это не так. Свойство **StatusCode** будет содержать значение 24, которое указывает на ошибку.<br>- **DeviceHandleInUse** указывает на то, что в настоящее время другой процесс обменивается данными с устройством, что запрещает этому поставщику экземпляров WMI (инструментарию управления Windows) из запросов на обмен сообщениями. Попробуйте запустить команду WMI еще раз! <br> - **Отключено** указывает на то, что текущая политика режима управления предприятием (SEMM) не разрешена, поэтому хост-компьютеру не удалось получить доступ к компоненту устройства и использовать его. Для получения дополнительных сведений просмотрите поле свойства **PolicyState** .<br>- **NotSupportedByWmi** указывает, что подключенная Dock в настоящее время не поддерживается этим поставщиком WMI. Это состояние будет отображаться для Dock Surface 1, который в настоящее время не поддерживается этим поставщиком экземпляров WMI.|
| StatusCode       | значением | [Код ошибки диспетчера устройств](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages) , полученный из WMI-класса CIM_LogicalDevice (в *Cimwin32. mof*) | В следующем свойстве представлен код ошибки диспетчера устройств для заданного компонента Dock. Нулевое значение (0) указывает на то, что компонент Dock работает правильно; значение больше нуля (0) указывает на ошибку или возможную ошибку в компоненте Dock. Поскольку компонент Dock может перечисляться несколькими интерфейсами устройства, возможно, дополнительные коды ошибок диспетчера устройств. Это поле свойства содержит только один код ошибки, даже если у них есть несколько. Диспетчер устройств помечает устройство желтым восклицательным знаком только при возникновении определенного кода ошибки.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Поставщика         | Строка | Шестнадцатеричная строка, которая может находиться в диапазоне от "0x0000" до "0xFFFF"                                                                                                                                                                        | В следующем свойстве заметок указан идентификатор поставщика (VID) компонента устройства.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Версия          | Строка | Строка версии, которая имеет следующий вид: "x. y. z", где x, y и z — числовые значения.                                                                                                                            | В следующем свойстве указывается текущая версия микропрограммы, которая в данный момент выполняется в компоненте устройства.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


##  <a name="learn-more"></a>Подробнее

- [Обеспечение безопасности портов Surface Dock 2 с помощью SEMM](secure-surface-dock-ports-semm.md)
- [Новые возможности Surface Dock 2](surface-dock-whats-new.md)
- [Коды ошибок диспетчера устройств](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages)
- [Работа с WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true)
