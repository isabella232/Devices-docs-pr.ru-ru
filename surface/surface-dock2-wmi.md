---
title: Управление Surface Dock 2 с помощью WMI
description: В этой статье рассказывается, как использовать WMI для удаленного мониторинга и управления последними прошивками, состоянием политики и связанными данными на устройствах Surface Dock 2.
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 10/12/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
appliesto:
- Windows 10
- Windows 11
ms.openlocfilehash: 658632220dfa87aa88fa233a7d55c311042a91cc
ms.sourcegitcommit: beb2f9db90b19b74da6cdee8717cc0888f3b1d70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/16/2022
ms.locfileid: "12448902"
---
# <a name="manage-surface-dock-2-with-wmi"></a>Управление Surface Dock 2 с помощью WMI

Windows средства управления (WMI) предоставляет богатый набор диагностических сведений, позволяющих ИТ-администраторам удаленно отслеживать и управлять последними прошивками, состоянием политики и связанными данными на устройствах Surface Dock 2. WMI можно использовать с Windows PowerShell, System Center диспетчером операций и другими средствами. Дополнительные сведения о WMI см. в [ссылке Работа с WMI](/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true). 

Чтобы включить поддержку WMI, перейдите в [Surface Dock 2 Drivers и Firmware](https://www.microsoft.com/download/details.aspx?id=101317) и скачайте соответствующий пакет:

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;Версии&#62;_x64.msi:**<br>

- Surface Pro (5-й и более поздний)
- Surface Book (2nd Gen и более поздний)
- Surface Go (все поколения)
- Surface Laptop (все поколения)
- Surface Laptop Go

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;Версии&#62;_arm64.msi:** <br>

- Surface Pro X

## <a name="using-wmi-with-surface-dock-2"></a>Использование WMI с surface Dock 2

1. Для переумерия всех экземпляров компонентов док-станции:

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. Чтобы получить доступ к описаниям свойств класса WMI, откройте командную подсказку и введите команды WMI, в которых **Свойство** является одним из свойств, перечисленных в таблице 1.

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **Пример:** Чтобы получить доступ к описанию свойства **Version** Common Information Model (CIM), введите следующее:
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ### <a name="table-1-surface-dock-2-wmi-reference"></a>Таблица 1: Справка по WMI Surface Dock 2

| Свойство         | Тип   | Ожидаемое значение(ы)                                                                                                                                                                                                            | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | Строка | "Микроконтроллер" <br>"USB Hub 1" <br>"USB Hub 2" <br>"Дисплей порт-концентратор" <br>"Контроллер доставки питания" <br>"Audio Codec" <br>Контроллер Ethernet                                                                         | В следующем свойстве перечислены конкретные имена компонента устройства, соответствующие данным класса общей информационной модели (CIM).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| DeviceName       | Строка | "Surface Dock 1" <br>"Surface Dock 2"                                                                                                                                                                                        | В следующем свойстве содержится имя док-устройства, к которой принадлежит определенный компонент устройства.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | Строка | 12 (12) цифр серийный номер, содержащий только численное значение                                                                                                                                                           | Следующее свойство записует серийный номер подключенного док-устройства. Этот серийный номер является одинаковым для каждого компонента, так как он принадлежит одному и одному устройству дока. Для справки этот серийный номер можно найти физически в самой док-станции Surface.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Id               | uint16 | 0, 1, 2, ..., 65535                                                                                                                                                                                                          | Следующее свойство — уникальный ID, который начинается с нуля (0) и учитывается. Эта переменная используется для номеров экземпляров WMI, заданной в переумещении.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | Строка | "Успех" <br>"PendingDockReattach" <br>"Failed"                                                                                                                                                                             | В следующем свойстве приводится последняя попытка обновления компонентов обновления прошивки (CFU) для компонента устройства, о чем идет речь. Возможные значения: **успешность,** **ожидание повторной док-станции и** **сбой.**<br><br><br>- **Успех** показывает, что ранее примененные новые прошивки были успешно применены<br>- **Ожидание повторной** док-станции указывает на то, что для компонента устройства ожидается новое обновление, и для применения нового обновления пользователю необходимо отсоединять и повторно прикрепить соединитатель Surface Dock.<br>- **Сбой** указывает на то, что возможная законная ошибка произошла во время процесса CFU или периферийное устройство не загрузилось в ожидаемую версию. В случае **failed** это не указывает на то, что устройство не работает, а скорее, что-то ошибочное произошло при попытке обновить устройство. В этом случае предыдущее прошивка будет продолжать работать.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| PolicyState      | Строка | "Включено" <br>"Отключено"                                                                                                                                                                                                     | В следующем свойстве указана текущая политика Enterprise режима управления (SEMM) для компонента устройства. Возможные значения: **Включено** и **отключено.**<br><br><br>- **Включено** указывает, что система SEMM позволила хост-устройству получить доступ к компоненту устройства и использовать его<br>- **Отключение** указывает на то, что система SEMM отключила и тем самым не позволяет хост-машине получать доступ к компоненту устройства и использовать его.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProductId        | String[] | Список строк hex, которые могут варьироваться от "0x0000" до "0xFFFF"                                                                                                                                                        | Следующее свойство классифицирует ID продукта (PID) компонента устройства. В списке может быть несколько pid. Например, в случае USB-концентратора устройства Super Speed (SS) и High Speed (HS) сгустились в единую "концентратор". Таким образом, в этом массиве будут перечислены два (2) PID.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProvisionedState         | логический | True или False                                                                                                                                                        | В следующем свойстве описывается Enterprise режим управления (SEMM) на устройстве Surface Dock. Предварительное состояние является одинаковым для каждого компонента, так как они принадлежат одному устройству дока. Возможные значения: True или False. Значение true указывает, что устройство Surface Dock в настоящее время управляется и, следовательно, функциональность порта может быть ограничена. Дополнительные сведения см. в поле свойств "PolicyState". Значение false указывает, что устройство Surface Dock в настоящее время не управляется и не имеет ограничений на функции.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Состояние           | Строка | "ОК" <br>"Отключено" <br>"Ошибка" <br>"Отсутствует" <br>"DeviceHandleInUse" <br>"Отключено" <br>"NotSupportedByWmi"                                                                                                             | В следующем свойстве описывается состояние подключения дока к хост-машине. Возможные значения: **OK,** **Disconnected,** **Error,** **Missing,** **DeviceHandleInUse,** **Disabled и** **NotSupportedByWmi.**   <br>- **ОК указывает** , что устройство успешно подключено к хост-машине и никаких проблем не существует, что бы препятствовать его функциональности <br>- **Отключение** указывает на то, что соединителя Surface, который обеспечивает подключение для всех компонентов устройства, в настоящее время не присоединен к хост-машине. <br>- **Ошибка** указывает на потенциальную проблему с экземпляром устройства, и интерфейс устройства, скорее всего, был помечен желтым восклицательный знак в диспетчере устройств — проверьте свойство **StatusCode** для получения более подробных сведений о типе ошибки, которая произошла. <br>- **Отсутствие** указывает на то, что устройство должно было быть указано на хост-машине, но по каким-либо причинам этого не сделал. Свойство **StatusCode** будет удерживать значение 24, чтобы указать эту ошибочную ситуацию.<br>- **DeviceHandleInUse** указывает, что в настоящее время с устройством идет другой процесс, который запрещает поставщику экземпляров Windows управления (WMI) от его запросов на связь. Попробуйте снова выполнять команду WMI! <br> - **Отключение** указывает на то, что текущая политика режима Enterprise Surface (SEMM) отключила и тем самым не позволяет хост-машине получать доступ к компоненту устройства и использовать его. Дополнительные **сведения см. в поле свойств PolicyState** .<br>- **NotSupportedByWmi** указывает, что подключенная док-станция в настоящее время не поддерживается этим поставщиком WMI. Этот статус появится для surface Dock 1, который в настоящее время не поддерживается этим поставщиком экземпляров WMI.|
| StatusCode       | uint32 | [Код ошибки](/windows-hardware/drivers/install/device-manager-error-messages) диспетчера устройств, полученный CIM_LogicalDevice класса WMI (в *cimwin32.mof*) | В следующем свойстве содержится код ошибки диспетчера устройств для данного компонента док-станции. Значение 0 (0) указывает, что компонент дока работает правильно; значение, большее нуля (0), указывает на проблему или возможную ошибку с компонентом дока. Так как компонент док-станции может оказаться в нескольких интерфейсах устройств, возможно, могут появиться дополнительные коды ошибок диспетчера устройств. В этом поле свойств перечислены только один код ошибки, даже если доступно несколько. Диспетчер устройств будет метить устройство желтым восклицательный знак только при определенных кодах ошибок.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| VendorId         | Строка | Строка hex, которая может варьироваться от "0x0000" до "0xFFFF"                                                                                                                                                                        | В следующем свойстве замечу конкретный ID поставщика (VID) компонента устройства.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| версия          | Строка | Строка версии, которая имеет форму: "x.y.z", где x, y и z являются числовые значения.                                                                                                                            | Следующее свойство указывает текущую версию прошивки, которая в настоящее время запущена на компоненте устройства.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


## <a name="learn-more"></a>Подробнее

- [Обеспечение безопасности портов Surface Dock 2 с помощью SEMM](secure-surface-dock-ports-semm.md)
- [Новые возможности Surface Dock 2](surface-dock-whats-new.md)
- [Коды ошибок диспетчера устройств](/windows-hardware/drivers/install/device-manager-error-messages)
- [Работа с WMI](/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true)
